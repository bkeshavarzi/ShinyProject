shiny::runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
library(DT)
DT::dataTableOutput("table")
install.packages('DT')
runApp('RProject/ShinyApp')
round(2.1232329,3)
View(df_pavement_info)
runApp('RProject/ShinyApp')
shiny::runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
shiny::runApp('RProject/ShinyApp')
View(df_traffic)
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
df=df_traffic %>% filter(STATE_CODE_EXP==input$ESAL_state&YEAR==input$ESAL_year) %>% group_by(SHRP_ID) %>% summarise(ave_ESAL=mean(ESAL))
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1995) %>% group_by(SHRP_ID) %>% summarise(ave_ESAL=mean(ESAL))
View(df)
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1995)
df=df_traffic %>% filter(STATE_CODE_EXP==input$ESAL_state&YEAR==input$ESAL_year)
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1995)
ggplot(df)+geom_boxplot(aes(x=YEAR,y=ESAL,group=YEAR))
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1950)
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama')
x=sort(unique(df$YEAR))
length(x)
View(x)
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
rm(list=ls())
library(tidyverse)
library(googleVis)
library(DT)
rm(list=ls())
setwd("C:\\Users\\behroozk\\Documents\\RProject\\ShinyApp\\")
rm(list=ls())
df_pavement_SHRP=read.csv("PavementStructure_SHRP_Info.csv",stringsAsFactors = FALSE)
df_pavement_info=read.csv("PavementStructure_Pavement_Info.csv")
Out_of_US=c("Alberta","British Columbia","New Brunswick","Newfoundland","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Manitoba")
df_pavement_info=df_pavement_info %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>%select(STATE_CODE_EXP,SHRP_ID,CONSTRUCTION_NO,LAYER_NO,LAYER_TYPE,LAYER_TYPE_EXP,REPR_THICKNESS)
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>% select(STATE_CODE_EXP,STATE_CODE,SHRP_ID,START_DATE,END_DATE)
df_pavement_info$LAYER_TYPE_EXP=str_replace(df_pavement_info$LAYER_TYPE_EXP,"layer","")
df_pavement_info=df_pavement_info %>% filter(!is.na(REPR_THICKNESS))
df_pavement_SHRP$START_DATE=as.Date(df_pavement_SHRP$START_DATE,"%m/%d/%Y")
df_pavement_SHRP$END_DATE=as.Date(df_pavement_SHRP$END_DATE,"%m/%d/%Y")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP$END_DATE=str_replace(df_pavement_SHRP$END_DATE,"2050","2005")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(duration<0))
df_pavement_SHRP=df_pavement_SHRP %>% group_by(STATE_CODE_EXP,STATE_CODE,SHRP_ID) %>% summarise(syear=min(as.integer(substr(START_DATE,1,4))),eyear=max(as.integer(substr(END_DATE,1,4))),duration=sum(duration))
df_pavement_info_AC=df_pavement_info %>% filter(LAYER_TYPE=='AC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
df_pavement_info_PC=df_pavement_info %>% filter(LAYER_TYPE=='PC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
pavement_data_AC=inner_join(df_pavement_SHRP,df_pavement_info_AC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
pavement_data_PC=inner_join(df_pavement_SHRP,df_pavement_info_PC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
df_pavement_info$CN=factor(df_pavement_info$CONSTRUCTION_NO)
df_gps=read.csv('GPS.csv',stringsAsFactors = FALSE)[,c(1,2,3,4,5,9)]
df_gps=df_gps %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_gps$ELEVATION=round(df_gps$ELEVATION,digits=2)
state_list=unique(df_pavement_info$STATE_CODE_EXP)
state_list=sort(state_list,decreasing = FALSE)
layer_type_list=sort(unique(df_pavement_info$LAYER_TYPE))
df_mera_shrp=read.csv("MERA_SHRP.csv",stringsAsFactors = FALSE)
df_mera_temp_month=read.csv("MERRA_TEMP_MONTH.csv",stringsAsFactors = FALSE)
df_mera_temp_month=df_mera_temp_month %>% select(!FREEZE_INDEX & !FREEZE_THAW)
df_mera_temp_month=df_mera_temp_month %>% mutate(Tave_F=1.8*TEMP_AVG+32)
df_mera_temp_month=df_mera_temp_month %>% select(!TEMP_AVG & !TEMP_MEAN_AVG)
df_temperature=inner_join(df_mera_shrp,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_temperature=inner_join(df_temperature,df_mera_temp_month,by="MERRA_ID")
temperature_state_list=sort(unique(df_temperature$STATE_CODE_EXP),decreasing = FALSE)
temperature_year_list=sort(unique(df_temperature$YEAR),decreasing = FALSE)
temperature_month_number_list=sort(unique(df_temperature$MONTH),decreasing = FALSE)
temperature_month_list=c('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')
df_traffic=read.csv("Traffic.csv",stringsAsFactors = FALSE)[,seq(1,6)]
df_traffic=df_traffic %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_traffic=inner_join(df_traffic,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_traffic=df_traffic %>% mutate(LatLong=paste(LATITUDE,LONGITUDE,sep=":"))
colnames(df_traffic)[6]="ESAL"
traffic_state=sort(unique(df_traffic$STATE_CODE_EXP),decreasing = FALSE)
traffic_year=sort(unique(df_traffic$YEAR),decreasing = FALSE)
traffic_SHRP=sort(unique(df_traffic$SHRP_ID))
df_IRI=read.csv("IRI.csv",stringsAsFactors = FALSE)
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US)) %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH,CONSTRUCTION_NO)
df_IRI=df_IRI %>% mutate(IRI_ave=ave(IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH))
df_IRI$VISIT_DATE=as.Date(df_IRI$VISIT_DATE,format ="%m/%d/%Y")
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID) %>% arrange(VISIT_DATE,CONSTRUCTION_NO)
df_IRI=df_IRI %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO,IRI_ave)
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO) %>% summarise(IRI=mean(IRI_ave),Date=min(VISIT_DATE))
df_IRI=df_IRI %>% filter(!is.na(IRI))
IRI_state=sort(unique(df_IRI$STATE_CODE_EXP))
IRI_shrp=unique((df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(SHRP_ID))[,1])
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI)
View(df1)
df2=df1 %>% group_by(SHRP_ID) %>% summarise(min_year=min(Date),max_year=max(Date))
df1$day=NA
for (ishrp in unique(df1$SHRP_ID)) {
df1[df1$SHRP_ID==ishrp,'day']$day=as.integer(df1[df1$SHRP_ID==ishrp,'Date']$Date-min(df1[df1$SHRP_ID==ishrp,'Date']$Date))
}
ishrp=unique(df1$SHRP_ID)[1]
x=as.integer(df1[df1$SHRP_ID==ishrp,'Date']$Date-min(df1[df1$SHRP_ID==ishrp,'Date']$Date))
df1[df1$SHRP_ID==ishrp,'day']$day=x
class(x)
class(df1[df1$SHRP_ID==ishrp,'day']$day)
class(df1[df1$SHRP_ID==ishrp,'day'])
class(df1[df1$SHRP_ID==ishrp,'day']$day)
df1$day=1
class(df1$day)
df1[df1$SHRP_ID==ishrp,'day']$day=x
for (ishrp in unique(df1$SHRP_ID)) {
df1[df1$SHRP_ID==ishrp,'day']$day=as.integer(df1[df1$SHRP_ID==ishrp,'Date']$Date-min(df1[df1$SHRP_ID==ishrp,'Date']$Date))
}
df1$survey_date=format(df1$VISIT_DATE,'%Y')
df3= df1 %>% group_by(SHRP_ID,survey_date) %>% summarise(max_IRI=max(IRI))
View(df3)
df3= df1 %>% group_by(SHRP_ID) %>% summarise(max_IRI=max(IRI),min_IRI=min(IRI),duration=max(survey_date)-min(survey_date))
df1$survey_date=as.integer(df1$survey_date)
df3= df1 %>% group_by(SHRP_ID) %>% summarise(max_IRI=max(IRI),min_IRI=min(IRI),duration=max(survey_date)-min(survey_date))
x=as.integer(df1$VISIT_DATE-df1$VISIT_DATE[1])
x=(df1$VISIT_DATE-df1$VISIT_DATE[1])
View(x)
x=as.integer(df1$VISIT_DATE-df1$VISIT_DATE[1])
View(x)
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI)
View(df1)
df1$day=0
df1$IRI_slope=0
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI_t']$IRI_t)
min_date=min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE)
days=as.integer(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE-min_date)
df1[df1$SHRP_ID==ishrp,'day']$day=as.integer(df1[df1$SHRP_ID==ishrp,'Date']$Date-min(df1[df1$SHRP_ID==ishrp,'Date']$Date))
df1[df1$SHRP_ID==ishrp,'IRI_slope']$IRI_slope=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)/days
}
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE)
days=as.integer(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE-min_date)
df1[df1$SHRP_ID==ishrp,'day']$day=as.integer(df1[df1$SHRP_ID==ishrp,'Date']$Date-min(df1[df1$SHRP_ID==ishrp,'Date']$Date))
df1[df1$SHRP_ID==ishrp,'IRI_slope']$IRI_slope=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)/days
}
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI)
df1$day=0
df1$delta_IRI=0
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE)
days=as.integer(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE-min_date)
df1[df1$SHRP_ID==ishrp,'day']$day=as.integer(df1[df1$SHRP_ID==ishrp,'Date']$Date-min(df1[df1$SHRP_ID==ishrp,'Date']$Date))
df1[df1$SHRP_ID==ishrp,'delta_IRI']$delta_IRI=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)
}
df1$surver_year=as.integer(format(df1$VISIT_DATE,'%Y'))
shiny::runApp()
library(tidyverse)
library(googleVis)
library(DT)
rm(list=ls())
setwd("C:\\Users\\behroozk\\Documents\\RProject\\ShinyApp\\")
rm(list=ls())
df_pavement_SHRP=read.csv("PavementStructure_SHRP_Info.csv",stringsAsFactors = FALSE)
df_pavement_info=read.csv("PavementStructure_Pavement_Info.csv")
Out_of_US=c("Alberta","British Columbia","New Brunswick","Newfoundland","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Manitoba")
df_pavement_info=df_pavement_info %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>%select(STATE_CODE_EXP,SHRP_ID,CONSTRUCTION_NO,LAYER_NO,LAYER_TYPE,LAYER_TYPE_EXP,REPR_THICKNESS)
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>% select(STATE_CODE_EXP,STATE_CODE,SHRP_ID,START_DATE,END_DATE)
df_pavement_info$LAYER_TYPE_EXP=str_replace(df_pavement_info$LAYER_TYPE_EXP,"layer","")
df_pavement_info=df_pavement_info %>% filter(!is.na(REPR_THICKNESS))
df_pavement_SHRP$START_DATE=as.Date(df_pavement_SHRP$START_DATE,"%m/%d/%Y")
df_pavement_SHRP$END_DATE=as.Date(df_pavement_SHRP$END_DATE,"%m/%d/%Y")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP$END_DATE=str_replace(df_pavement_SHRP$END_DATE,"2050","2005")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(duration<0))
df_pavement_SHRP=df_pavement_SHRP %>% group_by(STATE_CODE_EXP,STATE_CODE,SHRP_ID) %>% summarise(syear=min(as.integer(substr(START_DATE,1,4))),eyear=max(as.integer(substr(END_DATE,1,4))),duration=sum(duration))
df_pavement_info_AC=df_pavement_info %>% filter(LAYER_TYPE=='AC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
df_pavement_info_PC=df_pavement_info %>% filter(LAYER_TYPE=='PC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
pavement_data_AC=inner_join(df_pavement_SHRP,df_pavement_info_AC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
pavement_data_PC=inner_join(df_pavement_SHRP,df_pavement_info_PC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
df_pavement_info$CN=factor(df_pavement_info$CONSTRUCTION_NO)
df_gps=read.csv('GPS.csv',stringsAsFactors = FALSE)[,c(1,2,3,4,5,9)]
df_gps=df_gps %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_gps$ELEVATION=round(df_gps$ELEVATION,digits=2)
state_list=unique(df_pavement_info$STATE_CODE_EXP)
state_list=sort(state_list,decreasing = FALSE)
layer_type_list=sort(unique(df_pavement_info$LAYER_TYPE))
df_mera_shrp=read.csv("MERA_SHRP.csv",stringsAsFactors = FALSE)
df_mera_temp_month=read.csv("MERRA_TEMP_MONTH.csv",stringsAsFactors = FALSE)
df_mera_temp_month=df_mera_temp_month %>% select(!FREEZE_INDEX & !FREEZE_THAW)
df_mera_temp_month=df_mera_temp_month %>% mutate(Tave_F=1.8*TEMP_AVG+32)
df_mera_temp_month=df_mera_temp_month %>% select(!TEMP_AVG & !TEMP_MEAN_AVG)
df_temperature=inner_join(df_mera_shrp,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_temperature=inner_join(df_temperature,df_mera_temp_month,by="MERRA_ID")
temperature_state_list=sort(unique(df_temperature$STATE_CODE_EXP),decreasing = FALSE)
temperature_year_list=sort(unique(df_temperature$YEAR),decreasing = FALSE)
temperature_month_number_list=sort(unique(df_temperature$MONTH),decreasing = FALSE)
temperature_month_list=c('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')
df_traffic=read.csv("Traffic.csv",stringsAsFactors = FALSE)[,seq(1,6)]
df_traffic=df_traffic %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_traffic=inner_join(df_traffic,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_traffic=df_traffic %>% mutate(LatLong=paste(LATITUDE,LONGITUDE,sep=":"))
colnames(df_traffic)[6]="ESAL"
traffic_state=sort(unique(df_traffic$STATE_CODE_EXP),decreasing = FALSE)
traffic_year=sort(unique(df_traffic$YEAR),decreasing = FALSE)
traffic_SHRP=sort(unique(df_traffic$SHRP_ID))
df_IRI=read.csv("IRI.csv",stringsAsFactors = FALSE)
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US)) %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH,CONSTRUCTION_NO)
df_IRI=df_IRI %>% mutate(IRI_ave=ave(IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH))
df_IRI$VISIT_DATE=as.Date(df_IRI$VISIT_DATE,format ="%m/%d/%Y")
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID) %>% arrange(VISIT_DATE,CONSTRUCTION_NO)
df_IRI=df_IRI %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO,IRI_ave)
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO) %>% summarise(IRI=mean(IRI_ave),Date=min(VISIT_DATE))
df_IRI=df_IRI %>% filter(!is.na(IRI))
IRI_state=sort(unique(df_IRI$STATE_CODE_EXP))
IRI_shrp=unique((df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(SHRP_ID))[,1])
f2=df_temperature %>% filter(STATE_CODE_EXP=='Alabama') %>% group_by(SHRP_ID,YEAR) %>% summarise(Tave=mean(Tave_F))
df2=df_temperature %>% filter(STATE_CODE_EXP=='Alabama') %>% group_by(SHRP_ID,YEAR) %>% summarise(Tave=mean(Tave_F))
View(df2)
df1=df_IRI %>% filter(STATE_CODE_EXP==input$IRI_state_2) %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI)
#df2=df1 %>% group_by(SHRP_ID) %>% summarise(min_year=min(Date),max_year=max(Date))
df1$day=0
df1$delta_IRI=0
df1$surver_year=as.integer(format(df1$VISIT_DATE,'%Y'))
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE)
days=as.integer(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE-min_date)
df1[df1$SHRP_ID==ishrp,'day']$day=as.integer(df1[df1$SHRP_ID==ishrp,'Date']$Date-min(df1[df1$SHRP_ID==ishrp,'Date']$Date))
df1[df1$SHRP_ID==ishrp,'delta_IRI']$delta_IRI=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)
}
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI)
df1$day=0
df1$delta_IRI=0
df1$surver_year=as.integer(format(df1$VISIT_DATE,'%Y'))
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE)
days=as.integer(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE-min_date)
df1[df1$SHRP_ID==ishrp,'day']$day=as.integer(df1[df1$SHRP_ID==ishrp,'Date']$Date-min(df1[df1$SHRP_ID==ishrp,'Date']$Date))
df1[df1$SHRP_ID==ishrp,'delta_IRI']$delta_IRI=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)
}
df3=inner_join(df1,df2,by=c('SHRP_ID'='SHRP_ID','survey_year'='YEAR'))
View(df1)
colnames(df1)
df3=inner_join(df1,df2,by=c('SHRP_ID'='SHRP_ID','surver_year'='YEAR'))
View(df3)
df1=df1 %>% filter(CONSTRUCTION_NO==1)
View(df1)
df3=inner_join(df1,df2,by=c('SHRP_ID'='SHRP_ID','surver_year'='YEAR'))
View(df3)
df1=df1 %>% group_by(SHRP_ID,surver_year) %>% summarise(max_diff_IRI=max(delta_IRI))
View(df1)
df3=inner_join(df1,df2,by=c('SHRP_ID'='SHRP_ID','surver_year'='YEAR'))
df3$Tave=round(df,0)
df3$Tave=round(df3$Tave,0)
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI)
View(df1)
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI) %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI)
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI) %>% filter(CONSTRUCTION_NO==1)
df1$day=0
df1$delta_IRI=0
df1$surver_year=as.integer(format(df1$VISIT_DATE,'%Y'))
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE)
days=as.integer(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE-min_date)
df1[df1$SHRP_ID==ishrp,'day']$day=as.integer(df1[df1$SHRP_ID==ishrp,'Date']$Date-min(df1[df1$SHRP_ID==ishrp,'Date']$Date))
df1[df1$SHRP_ID==ishrp,'delta_IRI']$delta_IRI=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)
}
df1=df1 %>% group_by(SHRP_ID,surver_year) %>% summarise(max_diff_IRI=max(delta_IRI))
df2=df_temperature %>% filter(STATE_CODE_EXP==input$IRI_state_2) %>% group_by(SHRP_ID,YEAR) %>% summarise(Tave=mean(Tave_F))
df2=df_temperature %>% filter(STATE_CODE_EXP=='Alabama') %>% group_by(SHRP_ID,YEAR) %>% summarise(Tave=mean(Tave_F))
View(df2)
df3=inner_join(df1,df2,by=c('SHRP_ID'='SHRP_ID','surver_year'='YEAR'))
df3$Tave=round(df3$Tave,0)
df3=inner_join(df1,df2,by=c('SHRP_ID'='SHRP_ID','surver_year'='YEAR'))
View(df3)
df3$Tave=round(df3$Tave,0)
df3=inner_join(df1,df2,by=c('SHRP_ID'='SHRP_ID','surver_year'='YEAR'))
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI) %>% filter(CONSTRUCTION_NO==1)
df1$delta_year=0
df1$delta_IRI=0
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=format(min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE),'%Y')
days=as.integer(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE-min_date)
df1[df1$SHRP_ID==ishrp,'delta_year']$delta_year=as.integer(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE-min_date)
df1[df1$SHRP_ID==ishrp,'delta_IRI']$delta_IRI=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)
}
ishrp
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=format(min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE),'%Y')
df1[df1$SHRP_ID==ishrp,'delta_year']$delta_year=as.integer(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE-min_date)
x=df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE-min_date
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=format(min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE),'%Y')
survey_year=format(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE,'%Y')
df1[df1$SHRP_ID==ishrp,'delta_year']$delta_year=as.integer(survey_year-min_date)
df1[df1$SHRP_ID==ishrp,'delta_IRI']$delta_IRI=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)
}
min_date=format(min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE),'%Y')
survey_year=format(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE,'%Y')
df1[df1$SHRP_ID==ishrp,'delta_year']$delta_year=as.integer(survey_year-min_date)
x=survey_year-min_date
class(survey_year)
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=as.integer(format(min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE),'%Y'))
survey_year=as.integer(format(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE,'%Y'))
df1[df1$SHRP_ID==ishrp,'delta_year']$delta_year=as.integer(survey_year-min_date)
df1[df1$SHRP_ID==ishrp,'delta_IRI']$delta_IRI=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)
}
View(df1)
df1=df1 %>% group_by(SHRP_ID,delta_year) %>% summarise(max_diff_IRI=max(delta_IRI))
df2=df_temperature %>% filter(STATE_CODE_EXP==input$IRI_state_2) %>% group_by(SHRP_ID,YEAR) %>% summarise(Tave=mean(Tave_F))
View(df2)
df3=inner_join(df1,df2,by=c('SHRP_ID'='SHRP_ID','surver_year'='YEAR'))
View(df3)
View(df1)
View(df2)
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI) %>% filter(CONSTRUCTION_NO==1)
df1$delta_year=0
df1$delta_IRI=0
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=as.integer(format(min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE),'%Y'))
survey_year=as.integer(format(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE,'%Y'))
df1[df1$SHRP_ID==ishrp,'delta_year']$delta_year=as.integer(survey_year-min_date)
df1[df1$SHRP_ID==ishrp,'delta_IRI']$delta_IRI=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)
}
df1$survey_year=as.integer(format(df1$VISIT_DATE,'%Y'))
df1=df1 %>% group_by(SHRP_ID,survey_year) %>% summarise(dIRI=max(delta_IRI),dyear=min(delta_year))
View(df2)
df3=inner_join(df1,df2,by=c('SHRP_ID'='SHRP_ID','survey_year'='YEAR'))
View(df3)
ggplot(df3)+geom_point(aes(x=dyear,y=dIRI,color=Tave,shape=SHRP_ID))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear,color=Tave))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear,fill=Tave))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_jitter(aes(x=dyear,y=dIRI,color=Tave))
df4=df3 %>% group_by(dyear) %>% summarise(ave_temp=mean(Tave))
View(df4)
df4=df3 %>% group_by(dyear) %>% summarise(ave_IRI=mean(dIRI),max_IRI=max(dIRI),min_temp=min(dIRI))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_jitter(aes(x=dyear,y=dIRI,color=Tave))+geom_point(data=df4,aes(x=dyear,y=ave_IR,color=sdsd))
df4=df3 %>% group_by(dyear) %>% summarise(ave_IRI=mean(dIRI),max_IRI=max(dIRI),min_temp=min(dIRI),)
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_jitter(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IR,color='black'))+geom_line(data=df4,aes(x=dyear,y=min_IRI,color='blue')+geom_line(data=df4,aes(x=dyear,y=max_IRI,color='red'))
)
View(df4)
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_jitter(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI,color='black'))+geom_line(data=df4,aes(x=dyear,y=min_IRI,color='blue'))+geom_line(data=df4,aes(x=dyear,y=max_IRI,color='red'))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_jitter(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI,color='black'))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_jitter(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_jitter(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI))+scale_fill_brewer(palette="BuPu")
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI))+scale_fill_brewer(palette="BuPu")
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI))+scale_fill_brewer(palette="BuPu")+scale_y_continuous(breaks = seq(0,0.5,0.1))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI))+scale_fill_brewer(palette="BuPu")+ylim(0,0.5)
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI),linetype='dashed')+scale_fill_brewer(palette="BuPu")+ylim(0,0.5)
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI),linetype='dashed')+scale_fill_brewer(palette="Dark2")+ylim(0,0.5)
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI),linetype='dashed')+scale_fill_brewer('red')+ylim(0,0.5)
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI),linetype='dashed')+scale_fill_gradient('red')+ylim(0,0.5)
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI),linetype='dashed')+scale_fill_gradient2(low='blue',high = 'red')+ylim(0,0.5)
ggplot(df3)+geom_point(aes(x=dyear,y=dIRI,color=Tave))+scale_fill_gradient2(low='blue',high = 'red')
ggplot(df3)+geom_point(aes(x=dyear,y=dIRI,fill=Tave))+scale_fill_gradient2(low='blue',high = 'red')
ggplot(df3)+geom_point(aes(x=dyear,y=dIRI,fill=Tave))
ggplot(df3)+geom_point(aes(x=dyear,y=dIRI,fill=Tave))+scale_fill_distiller(palette = "Spectral")
ggplot(df3)+geom_point(aes(x=dyear,y=dIRI,color=Tave))+scale_fill_distiller(palette = "Spectral")
ggplot(df3)+geom_point(aes(x=dyear,y=dIRI,color=Tave))+scale_color_gradient(low="blue", high="red")
ggplot(df3)+geom_point(aes(x=dyear,y=dIRI,fill=Tave))+scale_fill_gradient(low="blue", high="red")
ggplot(df3)+geom_point(aes(x=dyear,y=dIRI,color=Tave))+scale_color_gradient(low="blue", high="red")
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave))+geom_line(data=df4,aes(x=dyear,y=ave_IRI),linetype='dashed')+scale_fill_gradient2(low='blue',high = 'red')+scale_color_gradient(low="blue", high="red")
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave),size=2)+geom_line(data=df4,aes(x=dyear,y=ave_IRI),linetype='dashed')+scale_fill_gradient2(low='blue',high = 'red')+scale_color_gradient(low="blue", high="red")
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave),size=1)+geom_line(data=df4,aes(x=dyear,y=ave_IRI),linetype='dashed')+scale_fill_gradient2(low='blue',high = 'red')+scale_color_gradient(low="blue", high="red")
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+geom_point(aes(x=dyear,y=dIRI,color=Tave),size=1)+geom_line(data=df4,aes(x=dyear,y=ave_IRI),linetype='dashed')+scale_fill_gradient2(low='blue',high = 'red')+scale_color_gradient(low="blue", high="red")
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+
geom_point(aes(x=dyear,y=dIRI,color=Tave),size=1)+scale_color_gradient(low="blue", high="red")+
labs(title=paste('IRI Evolution for State',input$IRI_state_2,'as a function of Annual Average Temperature',sep = ' '),
caption=('Data from LTPP'),tag='Figure 2',x='Temperature (F)',y='IRI')+theme_bw()+
theme(axis.text.x = element_text(face="bold", color="#993333",size=12))+theme(axis.text.y = element_text(face="bold", color="#993333",size=12))+
theme(axis.title = element_text(size = 14,color='#121111',face='bold'))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+
geom_point(aes(x=dyear,y=dIRI,color=Tave),size=1)+scale_color_gradient(low="blue", high="red")+
labs(title=paste('IRI Evolution for State','ff','as a function of Annual Average Temperature',sep = ' '),
caption=('Data from LTPP'),tag='Figure 2',x='Temperature (F)',y='IRI')+theme_bw()+
theme(axis.text.x = element_text(face="bold", color="#993333",size=12))+theme(axis.text.y = element_text(face="bold", color="#993333",size=12))+
theme(axis.title = element_text(size = 14,color='#121111',face='bold'))
ggplot(df3)+geom_boxplot(aes(x=dyear,y=dIRI,group=dyear))+
geom_point(aes(x=dyear,y=dIRI,color=Tave),size=1)+scale_color_gradient(low="blue", high="red")+
labs(title=paste('IRI Evolution for State','ff','as a function of Annual Average Temperature',sep = ' '),
caption=('Data from LTPP'),tag='Figure 2',x='Temperature (F)',y='IRI')+theme_bw()+
theme(axis.text.x = element_text(face="bold", color="#0f0000",size=12))+theme(axis.text.y = element_text(face="bold", color="#0f0000",size=12))+
theme(axis.title = element_text(size = 14,color='#0f0000',face='bold'))
