shiny::runApp('RProject/ShinyApp')
library(tidyverse)
library(googleVis)
rm(list=ls())
setwd("C:\\Users\\behroozk\\Documents\\RProject\\ShinyApp\\")
rm(list=ls())
df_pavement_SHRP=read.csv("PavementStructure_SHRP_Info.csv",stringsAsFactors = FALSE)
df_pavement_info=read.csv("PavementStructure_Pavement_Info.csv")
Out_of_US=c("Alberta","British Columbia","New Brunswick","Newfoundland","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Manitoba")
df_pavement_info=df_pavement_info %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>%select(STATE_CODE_EXP,SHRP_ID,CONSTRUCTION_NO,LAYER_NO,LAYER_TYPE,LAYER_TYPE_EXP,REPR_THICKNESS)
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>% select(STATE_CODE_EXP,STATE_CODE,SHRP_ID,START_DATE,END_DATE)
df_pavement_info$LAYER_TYPE_EXP=str_replace(df_pavement_info$LAYER_TYPE_EXP,"layer","")
df_pavement_info=df_pavement_info %>% filter(!is.na(REPR_THICKNESS))
df_pavement_SHRP$START_DATE=as.Date(df_pavement_SHRP$START_DATE,"%m/%d/%Y")
df_pavement_SHRP$END_DATE=as.Date(df_pavement_SHRP$END_DATE,"%m/%d/%Y")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP$END_DATE=str_replace(df_pavement_SHRP$END_DATE,"2050","2005")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(duration<0))
df_pavement_SHRP=df_pavement_SHRP %>% group_by(STATE_CODE_EXP,STATE_CODE,SHRP_ID) %>% summarise(syear=min(as.integer(substr(START_DATE,1,4))),eyear=max(as.integer(substr(END_DATE,1,4))),duration=sum(duration))
df_pavement_info_AC=df_pavement_info %>% filter(LAYER_TYPE=='AC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
df_pavement_info_PC=df_pavement_info %>% filter(LAYER_TYPE=='PC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
pavement_data_AC=inner_join(df_pavement_SHRP,df_pavement_info_AC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
pavement_data_PC=inner_join(df_pavement_SHRP,df_pavement_info_PC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
df_gps=read.csv('GPS.csv',stringsAsFactors = FALSE)[,c(1,2,3,4,5,9)]
df_gps=df_gps %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_gps$ELEVATION=round(df_gps$ELEVATION,digits=2)
state_list=unique(df_pavement_info$STATE_CODE_EXP)
state_list=sort(state_list,decreasing = FALSE)
layer_type_list=sort(unique(df_pavement_info$LAYER_TYPE))
df_mera_shrp=read.csv("MERA_SHRP.csv",stringsAsFactors = FALSE)
df_mera_temp_month=read.csv("MERRA_TEMP_MONTH.csv",stringsAsFactors = FALSE)
df_mera_temp_month=df_mera_temp_month %>% select(!FREEZE_INDEX & !FREEZE_THAW)
df_mera_temp_month=df_mera_temp_month %>% mutate(Tave_F=1.8*TEMP_AVG+32)
df_mera_temp_month=df_mera_temp_month %>% select(!TEMP_AVG & !TEMP_MEAN_AVG)
df_temperature=inner_join(df_mera_shrp,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_temperature=inner_join(df_temperature,df_mera_temp_month,by="MERRA_ID")
temperature_state_list=sort(unique(df_temperature$STATE_CODE_EXP),decreasing = FALSE)
temperature_year_list=sort(unique(df_temperature$YEAR),decreasing = FALSE)
temperature_month_number_list=sort(unique(df_temperature$MONTH),decreasing = FALSE)
temperature_month_list=c('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')
df_traffic=read.csv("Traffic.csv",stringsAsFactors = FALSE)[,seq(1,6)]
df_traffic=df_traffic %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_traffic=inner_join(df_traffic,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_traffic=df_traffic %>% mutate(LatLong=paste(LATITUDE,LONGITUDE,sep=":"))
colnames(df_traffic)[6]="ESAL"
traffic_state=sort(unique(df_traffic$STATE_CODE_EXP),decreasing = FALSE)
traffic_year=sort(unique(df_traffic$YEAR),decreasing = FALSE)
df_IRI=read.csv("IRI.csv",stringsAsFactors = FALSE)
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US)) %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH,CONSTRUCTION_NO)
df_IRI=df_IRI %>% mutate(IRI_ave=ave(IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH))
df_IRI$VISIT_DATE=as.Date(df_IRI$VISIT_DATE,format ="%m/%d/%Y")
df_IRI=df_IRI %>% group_by(STATE_CODE,SHRP_ID) %>% arrange(VISIT_DATE,CONSTRUCTION_NO)
df_IRI=df_IRI %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO,IRI_ave)
df_IRI=df_IRI %>% group_by(STATE_CODE,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO) %>% summarise(IRI=mean(IRI_ave),Date=min(VISIT_DATE))
df_IRI=df_IRI %>% filter(!is.na(IRI))
View(df_IRI)
library(tidyverse)
library(googleVis)
rm(list=ls())
setwd("C:\\Users\\behroozk\\Documents\\RProject\\ShinyApp\\")
rm(list=ls())
df_pavement_SHRP=read.csv("PavementStructure_SHRP_Info.csv",stringsAsFactors = FALSE)
df_pavement_info=read.csv("PavementStructure_Pavement_Info.csv")
Out_of_US=c("Alberta","British Columbia","New Brunswick","Newfoundland","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Manitoba")
df_pavement_info=df_pavement_info %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>%select(STATE_CODE_EXP,SHRP_ID,CONSTRUCTION_NO,LAYER_NO,LAYER_TYPE,LAYER_TYPE_EXP,REPR_THICKNESS)
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>% select(STATE_CODE_EXP,STATE_CODE,SHRP_ID,START_DATE,END_DATE)
df_pavement_info$LAYER_TYPE_EXP=str_replace(df_pavement_info$LAYER_TYPE_EXP,"layer","")
df_pavement_info=df_pavement_info %>% filter(!is.na(REPR_THICKNESS))
df_pavement_SHRP$START_DATE=as.Date(df_pavement_SHRP$START_DATE,"%m/%d/%Y")
df_pavement_SHRP$END_DATE=as.Date(df_pavement_SHRP$END_DATE,"%m/%d/%Y")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP$END_DATE=str_replace(df_pavement_SHRP$END_DATE,"2050","2005")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(duration<0))
df_pavement_SHRP=df_pavement_SHRP %>% group_by(STATE_CODE_EXP,STATE_CODE,SHRP_ID) %>% summarise(syear=min(as.integer(substr(START_DATE,1,4))),eyear=max(as.integer(substr(END_DATE,1,4))),duration=sum(duration))
df_pavement_info_AC=df_pavement_info %>% filter(LAYER_TYPE=='AC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
df_pavement_info_PC=df_pavement_info %>% filter(LAYER_TYPE=='PC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
pavement_data_AC=inner_join(df_pavement_SHRP,df_pavement_info_AC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
pavement_data_PC=inner_join(df_pavement_SHRP,df_pavement_info_PC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
df_gps=read.csv('GPS.csv',stringsAsFactors = FALSE)[,c(1,2,3,4,5,9)]
df_gps=df_gps %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_gps$ELEVATION=round(df_gps$ELEVATION,digits=2)
state_list=unique(df_pavement_info$STATE_CODE_EXP)
state_list=sort(state_list,decreasing = FALSE)
layer_type_list=sort(unique(df_pavement_info$LAYER_TYPE))
df_mera_shrp=read.csv("MERA_SHRP.csv",stringsAsFactors = FALSE)
df_mera_temp_month=read.csv("MERRA_TEMP_MONTH.csv",stringsAsFactors = FALSE)
df_mera_temp_month=df_mera_temp_month %>% select(!FREEZE_INDEX & !FREEZE_THAW)
df_mera_temp_month=df_mera_temp_month %>% mutate(Tave_F=1.8*TEMP_AVG+32)
df_mera_temp_month=df_mera_temp_month %>% select(!TEMP_AVG & !TEMP_MEAN_AVG)
df_temperature=inner_join(df_mera_shrp,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_temperature=inner_join(df_temperature,df_mera_temp_month,by="MERRA_ID")
temperature_state_list=sort(unique(df_temperature$STATE_CODE_EXP),decreasing = FALSE)
temperature_year_list=sort(unique(df_temperature$YEAR),decreasing = FALSE)
temperature_month_number_list=sort(unique(df_temperature$MONTH),decreasing = FALSE)
temperature_month_list=c('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')
df_traffic=read.csv("Traffic.csv",stringsAsFactors = FALSE)[,seq(1,6)]
df_traffic=df_traffic %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_traffic=inner_join(df_traffic,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_traffic=df_traffic %>% mutate(LatLong=paste(LATITUDE,LONGITUDE,sep=":"))
colnames(df_traffic)[6]="ESAL"
traffic_state=sort(unique(df_traffic$STATE_CODE_EXP),decreasing = FALSE)
traffic_year=sort(unique(df_traffic$YEAR),decreasing = FALSE)
df_IRI=read.csv("IRI.csv",stringsAsFactors = FALSE)
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US)) %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH,CONSTRUCTION_NO)
df_IRI=df_IRI %>% mutate(IRI_ave=ave(IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH))
df_IRI$VISIT_DATE=as.Date(df_IRI$VISIT_DATE,format ="%m/%d/%Y")
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID) %>% arrange(VISIT_DATE,CONSTRUCTION_NO)
df_IRI=df_IRI %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO,IRI_ave)
df_IRI=df_IRI %>% group_by(STATE_CODE,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO) %>% summarise(IRI=mean(IRI_ave),Date=min(VISIT_DATE))
df_IRI=df_IRI %>% filter(!is.na(IRI))
View(df_IRI)
library(tidyverse)
library(googleVis)
rm(list=ls())
setwd("C:\\Users\\behroozk\\Documents\\RProject\\ShinyApp\\")
rm(list=ls())
df_pavement_SHRP=read.csv("PavementStructure_SHRP_Info.csv",stringsAsFactors = FALSE)
df_pavement_info=read.csv("PavementStructure_Pavement_Info.csv")
Out_of_US=c("Alberta","British Columbia","New Brunswick","Newfoundland","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Manitoba")
df_pavement_info=df_pavement_info %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>%select(STATE_CODE_EXP,SHRP_ID,CONSTRUCTION_NO,LAYER_NO,LAYER_TYPE,LAYER_TYPE_EXP,REPR_THICKNESS)
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>% select(STATE_CODE_EXP,STATE_CODE,SHRP_ID,START_DATE,END_DATE)
df_pavement_info$LAYER_TYPE_EXP=str_replace(df_pavement_info$LAYER_TYPE_EXP,"layer","")
df_pavement_info=df_pavement_info %>% filter(!is.na(REPR_THICKNESS))
df_pavement_SHRP$START_DATE=as.Date(df_pavement_SHRP$START_DATE,"%m/%d/%Y")
df_pavement_SHRP$END_DATE=as.Date(df_pavement_SHRP$END_DATE,"%m/%d/%Y")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP$END_DATE=str_replace(df_pavement_SHRP$END_DATE,"2050","2005")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(duration<0))
df_pavement_SHRP=df_pavement_SHRP %>% group_by(STATE_CODE_EXP,STATE_CODE,SHRP_ID) %>% summarise(syear=min(as.integer(substr(START_DATE,1,4))),eyear=max(as.integer(substr(END_DATE,1,4))),duration=sum(duration))
df_pavement_info_AC=df_pavement_info %>% filter(LAYER_TYPE=='AC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
df_pavement_info_PC=df_pavement_info %>% filter(LAYER_TYPE=='PC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
pavement_data_AC=inner_join(df_pavement_SHRP,df_pavement_info_AC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
pavement_data_PC=inner_join(df_pavement_SHRP,df_pavement_info_PC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
df_gps=read.csv('GPS.csv',stringsAsFactors = FALSE)[,c(1,2,3,4,5,9)]
df_gps=df_gps %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_gps$ELEVATION=round(df_gps$ELEVATION,digits=2)
state_list=unique(df_pavement_info$STATE_CODE_EXP)
state_list=sort(state_list,decreasing = FALSE)
layer_type_list=sort(unique(df_pavement_info$LAYER_TYPE))
df_mera_shrp=read.csv("MERA_SHRP.csv",stringsAsFactors = FALSE)
df_mera_temp_month=read.csv("MERRA_TEMP_MONTH.csv",stringsAsFactors = FALSE)
df_mera_temp_month=df_mera_temp_month %>% select(!FREEZE_INDEX & !FREEZE_THAW)
df_mera_temp_month=df_mera_temp_month %>% mutate(Tave_F=1.8*TEMP_AVG+32)
df_mera_temp_month=df_mera_temp_month %>% select(!TEMP_AVG & !TEMP_MEAN_AVG)
df_temperature=inner_join(df_mera_shrp,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_temperature=inner_join(df_temperature,df_mera_temp_month,by="MERRA_ID")
temperature_state_list=sort(unique(df_temperature$STATE_CODE_EXP),decreasing = FALSE)
temperature_year_list=sort(unique(df_temperature$YEAR),decreasing = FALSE)
temperature_month_number_list=sort(unique(df_temperature$MONTH),decreasing = FALSE)
temperature_month_list=c('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')
df_traffic=read.csv("Traffic.csv",stringsAsFactors = FALSE)[,seq(1,6)]
df_traffic=df_traffic %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_traffic=inner_join(df_traffic,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_traffic=df_traffic %>% mutate(LatLong=paste(LATITUDE,LONGITUDE,sep=":"))
colnames(df_traffic)[6]="ESAL"
traffic_state=sort(unique(df_traffic$STATE_CODE_EXP),decreasing = FALSE)
traffic_year=sort(unique(df_traffic$YEAR),decreasing = FALSE)
df_IRI=read.csv("IRI.csv",stringsAsFactors = FALSE)
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US)) %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH,CONSTRUCTION_NO)
df_IRI=df_IRI %>% mutate(IRI_ave=ave(IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH))
df_IRI$VISIT_DATE=as.Date(df_IRI$VISIT_DATE,format ="%m/%d/%Y")
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID) %>% arrange(VISIT_DATE,CONSTRUCTION_NO)
df_IRI=df_IRI %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO,IRI_ave)
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO) %>% summarise(IRI=mean(IRI_ave),Date=min(VISIT_DATE))
df_IRI=df_IRI %>% filter(!is.na(IRI))
View(df_IRI)
View(df_pavement_SHRP)
View(df_pavement_info)
state_list=unique(df_pavement_info$STATE_CODE_EXP)
View(df_pavement_info)
df_pavement_info_th_histogram=df_pavement_info %>% filter(STATE_CODE_EXP==input$state_section_data) %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=)
df_pavement_info_th_histogram=df_pavement_info %>% filter(STATE_CODE_EXP==input$state_section_data) %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(PEPR_THICKNESS))
df_pavement_info_th_histogram=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(PEPR_THICKNESS))
df_pavement_info_th_histogram=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum('PEPR_THICKNESS'))
df_pavement_info_th_histogram=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum(PEPR_THICKNESS))
colnames(df_pavement_info)
df_pavement_info_th_histogram=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum(REPR_THICKNESS))
View(df_pavement_info_th_histogram)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(x=sum_))+geom_histogram(binwidth = 10)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(x=sum_))+geom_histogram(binwidth = 10)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(x=sum_))+geom_histogram(aes(color=CONSTRUCTION_NO),binwidth = 10)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS))
View(df)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&SHRP_ID=0001)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&SHRP_ID==0001)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS))
class(df_pavement_info$SHRP_ID)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&SHRP_ID=='0001')
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas')
max(df$CONSTRUCTION_NO)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas',CONSTRUCTION_NO==8)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&SHRP_ID=='C420')
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&SHRP_ID=='C420') %>% group_by(CONSTRUCTION_NO) %>% summarise(sum_=sum(PEPR_THICKNESS))
colnames(df)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&SHRP_ID=='C420') %>% group_by(CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS))
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&SHRP_ID=='C420')
View(df_mera_shrp)
View(df_pavement_SHRP)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas')
df2=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&SHRP_ID=='1122')
View(df2)
df2=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE_EXP=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(x=sum_))+geom_histogram(aes(fill=CONSTRUCTION_NO))
df2=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE_EXP=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(x=sum_))+geom_histogram(aes(fill=CONSTRUCTION_NO),binwidth = 20)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE_EXP=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(x=sum_))+geom_histogram(aes(fill=CONSTRUCTION_NO),binwidth = 20)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE_EXP=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(x=sum_))+geom_histogram(aes(fill=CONSTRUCTION_NO))
df2=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE_EXP=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS))
df2=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE_EXP=='AC')
df2=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas')
df2=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC')
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(x=sum_))+geom_histogram(aes(fill=CONSTRUCTION_NO))
df2=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(x=sum_))+geom_histogram(aes(color=CONSTRUCTION_NO))
df=mtcars
ggplot(aes(x=mpg))+geom_histogram(aes(fill=gear))
ggplot(df,aes(x=mpg))+geom_histogram(aes(fill=gear))
ggplot(df,aes(x=mpg))+geom_histogram(aes(colors=gear))
ggplot(df,aes(x=mpg))+geom_histogram(aes(color=gear))
ggplot(df,aes(x=mpg))+geom_bar(aes(color=gear))
ggplot(df,aes(x=mpg,fill=gear))+geom_bar(aes(color=gear))
ggplot(df,aes(x=mpg,fill=gear))+geom_histogram(aes(color=gear))
ggplot(df,aes(factor(mpg),fill=factor(gear)))+geom_histogram(aes(color=gear))
ggplot(df,aes(mpg,fill=factor(gear)))+geom_histogram(aes(color=gear))
ggplot(df,aes(mpg,fill=gear))+geom_histogram(aes(color=gear))
ggplot(df,aes(mpg,fill=factor(gear)))+geom_histogram(aes(color=gear))
ggplot(df,aes(mpg,color=factor(gear)))+geom_histogram(aes(color=gear))
class(df$mpg)
class(df$cyl)
ggplot(df,aes(mpg,color=factor(gear)))+geom_histogram(aes(color=gear))
ggplot(df,aes(mpg,fill=factor(gear)))+geom_histogram(aes(color=gear))
ggplot(df,aes(mpg,fill=factor(gear)))+geom_histogram(aes(color=gear),position = dodge)
ggplot(df,aes(mpg,fill=factor(gear)))+geom_histogram(aes(color=gear),position = 'dodge')
ggplot(df,aes(mpg,fill=factor(gear)))+geom_histogram(aes(color=gear),position = 'dodge2')
ggplot(mtcars, aes(factor(cyl), fill = factor(vs))) +
geom_bar(position = "dodge2")
ggplot(mtcars, aes(factor(cyl), fill = factor(vs))) +
geom_bar(position = "dodge2")
ggplot(mtcars, aes(factor(cyl), fill = factor(vs))) +
geom_bar(position = "stack")
ggplot(mtcars, aes(factor(cyl), fill = factor(vs))) +
geom_bar(position = "stack")
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_bar(position = "dodge2")
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2")
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2",binwidth = 10)
library(googleVis)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS))
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS))
Column <- gvisColumnChart(df)
plot(df)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2",binwidth = 10)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour='Construction Number')+theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colors='Construction Number')+theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colours='Construction Number')+theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+theme_bw()
df_pavement_info$CONSTRUCTION_NO=factor(df_pavement_info$CONSTRUCTION_NO)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+theme_economist() ()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=factor(CONSTRUCTION_NO)))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_economist() + scale_fill_economist()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_economist() + scale_fill_economist()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+guides(color='legend')
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_fill_discrete(name ="Legend name")
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_fill_discrete(low='blue',high='red')
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_fill_gradient2(low='blue',high='red')
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+guides(color='legend')
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_fill_fermenter(breaks = seq(1,8), palette = "Reds")
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CONSTRUCTION_NO))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()
df_pavement_info$CN=factor(df_pavement_info$CONSTRUCTION_NO)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CONSTRUCTION_NO) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 30, 10)
)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 30, 10))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 30, 10),lim=c(0,30))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 30, 10),lim=c(0,150))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 30, 10),lim=c(0,10))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 30, 10))
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS))
max(df$sum_)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 10))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 30)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 10))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 10))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 10))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 10)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 20, 10))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 15)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 20, 10))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 15)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "dodge2",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack",binwidth = 15)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 20, 10))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack",binwidth = 15)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 20, 10))
seq(0, 20, 10)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack",binwidth = 15)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 20, 5))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack",binwidth = 15)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 20, 2))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 20, 2))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 2))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack",binwidth = 20)+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))+geom_freqpoly()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))+geom_freqpoly(color=CN)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))+geom_freqpoly(aes(color=CN))
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))+geom_freqpoly()
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))+geom_freqpoly(binwidth=10)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))+geom_freqpoly(binwidth=300)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))+geom_freqpoly(binwidth=1)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))+geom_freqpoly(binwidth=0.5)
df_pavement_info %>% filter(STATE_CODE_EXP=='Texas'&LAYER_TYPE=='AC') %>% group_by(SHRP_ID,CN) %>% summarise(sum_=sum(REPR_THICKNESS)) %>% ggplot(aes(sum_,fill=CN))+geom_histogram(position = "stack")+labs(title="AC Thickness Distributation For Texas",subtitle = '1991-2005',caption='Data from LTPP',tag='Figure 1',x='AC Layer Thickness (in)',y='Frequency',colour = "Gears")+ theme_bw()+scale_x_continuous(breaks = seq(0, 16, 1))+geom_freqpoly(binwidth=0.1)
df=df_pavement_SHRP %>% filter(STATE_CODE_EXP=='Texas')
View(df)
rm(list=ls())
library(tidyverse)
library(googleVis)
rm(list=ls())
setwd("C:\\Users\\behroozk\\Documents\\RProject\\ShinyApp\\")
rm(list=ls())
df_pavement_SHRP=read.csv("PavementStructure_SHRP_Info.csv",stringsAsFactors = FALSE)
df_pavement_info=read.csv("PavementStructure_Pavement_Info.csv")
Out_of_US=c("Alberta","British Columbia","New Brunswick","Newfoundland","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Manitoba")
df_pavement_info=df_pavement_info %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>%select(STATE_CODE_EXP,SHRP_ID,CONSTRUCTION_NO,LAYER_NO,LAYER_TYPE,LAYER_TYPE_EXP,REPR_THICKNESS)
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>% select(STATE_CODE_EXP,STATE_CODE,SHRP_ID,START_DATE,END_DATE)
df_pavement_info$LAYER_TYPE_EXP=str_replace(df_pavement_info$LAYER_TYPE_EXP,"layer","")
df_pavement_info=df_pavement_info %>% filter(!is.na(REPR_THICKNESS))
df_pavement_SHRP$START_DATE=as.Date(df_pavement_SHRP$START_DATE,"%m/%d/%Y")
df_pavement_SHRP$END_DATE=as.Date(df_pavement_SHRP$END_DATE,"%m/%d/%Y")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP$END_DATE=str_replace(df_pavement_SHRP$END_DATE,"2050","2005")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(duration<0))
rm(list=ls())
library(tidyverse)
library(googleVis)
rm(list=ls())
setwd("C:\\Users\\behroozk\\Documents\\RProject\\ShinyApp\\")
rm(list=ls())
df_pavement_SHRP=read.csv("PavementStructure_SHRP_Info.csv",stringsAsFactors = FALSE)
df_pavement_info=read.csv("PavementStructure_Pavement_Info.csv")
Out_of_US=c("Alberta","British Columbia","New Brunswick","Newfoundland","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Manitoba")
df_pavement_info=df_pavement_info %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>%select(STATE_CODE_EXP,SHRP_ID,CONSTRUCTION_NO,LAYER_NO,LAYER_TYPE,LAYER_TYPE_EXP,REPR_THICKNESS)
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>% select(STATE_CODE_EXP,STATE_CODE,SHRP_ID,START_DATE,END_DATE)
df_pavement_info$LAYER_TYPE_EXP=str_replace(df_pavement_info$LAYER_TYPE_EXP,"layer","")
df_pavement_info=df_pavement_info %>% filter(!is.na(REPR_THICKNESS))
df_pavement_SHRP$START_DATE=as.Date(df_pavement_SHRP$START_DATE,"%m/%d/%Y")
df_pavement_SHRP$END_DATE=as.Date(df_pavement_SHRP$END_DATE,"%m/%d/%Y")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP$END_DATE=str_replace(df_pavement_SHRP$END_DATE,"2050","2005")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(duration<0))
df_pavement_SHRP=df_pavement_SHRP %>% group_by(STATE_CODE_EXP,STATE_CODE,SHRP_ID) %>% summarise(syear=min(as.integer(substr(START_DATE,1,4))),eyear=max(as.integer(substr(END_DATE,1,4))),duration=sum(duration))
df_pavement_info_AC=df_pavement_info %>% filter(LAYER_TYPE=='AC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
df_pavement_info_PC=df_pavement_info %>% filter(LAYER_TYPE=='PC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
pavement_data_AC=inner_join(df_pavement_SHRP,df_pavement_info_AC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
pavement_data_PC=inner_join(df_pavement_SHRP,df_pavement_info_PC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
df_pavement_info$CN=factor(df_pavement_info$CONSTRUCTION_NO)
df_gps=read.csv('GPS.csv',stringsAsFactors = FALSE)[,c(1,2,3,4,5,9)]
df_gps=df_gps %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_gps$ELEVATION=round(df_gps$ELEVATION,digits=2)
state_list=unique(df_pavement_info$STATE_CODE_EXP)
state_list=sort(state_list,decreasing = FALSE)
layer_type_list=sort(unique(df_pavement_info$LAYER_TYPE))
df_mera_shrp=read.csv("MERA_SHRP.csv",stringsAsFactors = FALSE)
df_mera_temp_month=read.csv("MERRA_TEMP_MONTH.csv",stringsAsFactors = FALSE)
df_mera_temp_month=df_mera_temp_month %>% select(!FREEZE_INDEX & !FREEZE_THAW)
df_mera_temp_month=df_mera_temp_month %>% mutate(Tave_F=1.8*TEMP_AVG+32)
df_mera_temp_month=df_mera_temp_month %>% select(!TEMP_AVG & !TEMP_MEAN_AVG)
df_temperature=inner_join(df_mera_shrp,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_temperature=inner_join(df_temperature,df_mera_temp_month,by="MERRA_ID")
temperature_state_list=sort(unique(df_temperature$STATE_CODE_EXP),decreasing = FALSE)
temperature_year_list=sort(unique(df_temperature$YEAR),decreasing = FALSE)
temperature_month_number_list=sort(unique(df_temperature$MONTH),decreasing = FALSE)
temperature_month_list=c('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')
df_traffic=read.csv("Traffic.csv",stringsAsFactors = FALSE)[,seq(1,6)]
df_traffic=df_traffic %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_traffic=inner_join(df_traffic,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_traffic=df_traffic %>% mutate(LatLong=paste(LATITUDE,LONGITUDE,sep=":"))
colnames(df_traffic)[6]="ESAL"
traffic_state=sort(unique(df_traffic$STATE_CODE_EXP),decreasing = FALSE)
traffic_year=sort(unique(df_traffic$YEAR),decreasing = FALSE)
df_IRI=read.csv("IRI.csv",stringsAsFactors = FALSE)
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US)) %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH,CONSTRUCTION_NO)
df_IRI=df_IRI %>% mutate(IRI_ave=ave(IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH))
df_IRI$VISIT_DATE=as.Date(df_IRI$VISIT_DATE,format ="%m/%d/%Y")
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID) %>% arrange(VISIT_DATE,CONSTRUCTION_NO)
df_IRI=df_IRI %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO,IRI_ave)
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO) %>% summarise(IRI=mean(IRI_ave),Date=min(VISIT_DATE))
df_IRI=df_IRI %>% filter(!is.na(IRI))
df=df_pavement_SHRP %>% filter(STATE_CODE_EXP=='Texas')
View(df)
ggplot(df,aes(x=duration))+geom_histogram()
paste('AC','B',sep='/')
paste('AC','Thickness Distributation For','Texas',sep=' ')
min_year=min(df$syear)
max_year=max(df$eyear)
df=df_pavement_SHRP %>% filter(STATE_CODE_EXP=='Texas')
ggplot(df,aes(x=duration))+geom_histogram()+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+scale_x_continuous(breaks = seq(0,16,2))
ggplot(df,aes(x=duration))+geom_histogram()+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+scale_x_continuous(breaks = seq(0,16,2))+theme_bw()
ggplot(df,aes(x=duration))+geom_histogram()+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+scale_x_continuous(breaks = seq(0,16,2))+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))
seq(0,16,2)
ggplot(df,aes(x=duration))+geom_histogram()+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+scale_x_continuous(breaks = seq(0,16,2))+theme_gray()+scale_y_continuous(breaks=seq(0,60,10))
ggplot(df,aes(x=duration))+geom_histogram()+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+scale_x_continuous(breaks = seq(0,16,2))+theme_linedraw+scale_y_continuous(breaks=seq(0,60,10))
ggplot(df,aes(x=duration))+geom_histogram()+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+scale_x_continuous(breaks = seq(0,16,2))+theme_linedraw()+scale_y_continuous(breaks=seq(0,60,10))
ggplot(df,aes(x=duration))+geom_histogram()+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+scale_x_continuous(breaks = seq(0,16,2))+theme_dark()+scale_y_continuous(breaks=seq(0,60,10))
ggplot(df,aes(x=duration))+geom_histogram()+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+scale_x_continuous(breaks = seq(0,16,2))+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))
ggplot(df,aes(x=duration))+geom_histogram()+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))
ggplot(df,aes(x=duration))+geom_histogram(binwidth = 10)+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))
ggplot(df,aes(x=duration))+geom_histogram(binwidth = 20)+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))
ggplot(df,aes(x=duration))+geom_histogram(binwidth = 30)+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))
ggplot(df,aes(x=duration))+geom_histogram(binwidth = 1)+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))
ggplot(df,aes(x=duration))+geom_histogram(binwidth = 1)+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))+scale_x_continuous(breaks = seq(0,16,2))
21
ggplot(df,aes(x=duration))+geom_histogram(binwidth = 1)+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))+scale_x_continuous(breaks = seq(0,16,1))
ggplot(df,aes(x=duration))+geom_histogram(binwidth = 1)+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))+scale_x_continuous(breaks = seq(0,30,1))
ggplot(df,aes(x=duration))+geom_histogram(binwidth = 1)+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))+scale_x_continuous(breaks = seq(0,50,1))
ggplot(df,aes(x=duration))+geom_histogram(binwidth = 0.5)+labs(title=paste('Section Life Distributation','in Texas',sep=' '),subtitle = '1990-2015',caption='Data from LTPP',tag='Figure 2',x='Section Life (Year)',y='Frequency')+theme_bw()+scale_y_continuous(breaks=seq(0,60,10))+scale_x_continuous(breaks = seq(0,50,1))
round(61/10)*10+10
View(df_gps)
min(c(1,2,3,1))
library(leaflet)
m=leaflet(df_gps) %>% addTiles() %>% addMarkers(lng=LONGITUDE,lat=LATITUDE)
m=leaflet(df_gps) %>% addTiles() %>% addMarkers(lng=df_gps$LONGITUDE,lat=df_gps$LATITUDE)
plot(m)
m
m=leaflet(df_gps) %>% addTiles() %>% addCircleMarkers(lng=df_gps$LONGITUDE,lat=df_gps$LATITUDE) %>% addProviderTiles('Stamen.Terrain')
m
m=leaflet(df_gps) %>% addTiles() %>% addMarkers(lng=df_gps$LONGITUDE,lat=df_gps$LATITUDE) %>% addProviderTiles('Stamen.Terrain')
m
m=leaflet(df_gps) %>% addTiles() %>% addMarkers(lng=df_gps$LONGITUDE,lat=df_gps$LATITUDE) %>% addProviderTiles('Stamen.Terrain') %>%
addMeasure(position = 'bottomleft',primaryLengthUnit = 'feet',primaryAreaUnit = 'sqfeet')
m
