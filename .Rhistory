shiny::runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
library(DT)
DT::dataTableOutput("table")
install.packages('DT')
runApp('RProject/ShinyApp')
round(2.1232329,3)
View(df_pavement_info)
runApp('RProject/ShinyApp')
shiny::runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
shiny::runApp('RProject/ShinyApp')
View(df_traffic)
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
df=df_traffic %>% filter(STATE_CODE_EXP==input$ESAL_state&YEAR==input$ESAL_year) %>% group_by(SHRP_ID) %>% summarise(ave_ESAL=mean(ESAL))
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1995) %>% group_by(SHRP_ID) %>% summarise(ave_ESAL=mean(ESAL))
View(df)
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1995)
df=df_traffic %>% filter(STATE_CODE_EXP==input$ESAL_state&YEAR==input$ESAL_year)
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1995)
ggplot(df)+geom_boxplot(aes(x=YEAR,y=ESAL,group=YEAR))
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1950)
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama')
x=sort(unique(df$YEAR))
length(x)
View(x)
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
library(tidyverse)
library(googleVis)
library(DT)
rm(list=ls())
setwd("C:\\Users\\behroozk\\Documents\\RProject\\ShinyApp\\")
rm(list=ls())
df_pavement_SHRP=read.csv("PavementStructure_SHRP_Info.csv",stringsAsFactors = FALSE)
df_pavement_info=read.csv("PavementStructure_Pavement_Info.csv")
Out_of_US=c("Alberta","British Columbia","New Brunswick","Newfoundland","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Manitoba")
df_pavement_info=df_pavement_info %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>%select(STATE_CODE_EXP,SHRP_ID,CONSTRUCTION_NO,LAYER_NO,LAYER_TYPE,LAYER_TYPE_EXP,REPR_THICKNESS)
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>% select(STATE_CODE_EXP,STATE_CODE,SHRP_ID,START_DATE,END_DATE)
df_pavement_info$LAYER_TYPE_EXP=str_replace(df_pavement_info$LAYER_TYPE_EXP,"layer","")
df_pavement_info=df_pavement_info %>% filter(!is.na(REPR_THICKNESS))
df_pavement_SHRP$START_DATE=as.Date(df_pavement_SHRP$START_DATE,"%m/%d/%Y")
df_pavement_SHRP$END_DATE=as.Date(df_pavement_SHRP$END_DATE,"%m/%d/%Y")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP$END_DATE=str_replace(df_pavement_SHRP$END_DATE,"2050","2005")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(duration<0))
df_pavement_SHRP=df_pavement_SHRP %>% group_by(STATE_CODE_EXP,STATE_CODE,SHRP_ID) %>% summarise(syear=min(as.integer(substr(START_DATE,1,4))),eyear=max(as.integer(substr(END_DATE,1,4))),duration=sum(duration))
df_pavement_info_AC=df_pavement_info %>% filter(LAYER_TYPE=='AC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
df_pavement_info_PC=df_pavement_info %>% filter(LAYER_TYPE=='PC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
pavement_data_AC=inner_join(df_pavement_SHRP,df_pavement_info_AC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
pavement_data_PC=inner_join(df_pavement_SHRP,df_pavement_info_PC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
df_pavement_info$CN=factor(df_pavement_info$CONSTRUCTION_NO)
df_gps=read.csv('GPS.csv',stringsAsFactors = FALSE)[,c(1,2,3,4,5,9)]
df_gps=df_gps %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_gps$ELEVATION=round(df_gps$ELEVATION,digits=2)
state_list=unique(df_pavement_info$STATE_CODE_EXP)
state_list=sort(state_list,decreasing = FALSE)
layer_type_list=sort(unique(df_pavement_info$LAYER_TYPE))
df_mera_shrp=read.csv("MERA_SHRP.csv",stringsAsFactors = FALSE)
df_mera_temp_month=read.csv("MERRA_TEMP_MONTH.csv",stringsAsFactors = FALSE)
df_mera_temp_month=df_mera_temp_month %>% select(!FREEZE_INDEX & !FREEZE_THAW)
df_mera_temp_month=df_mera_temp_month %>% mutate(Tave_F=1.8*TEMP_AVG+32)
df_mera_temp_month=df_mera_temp_month %>% select(!TEMP_AVG & !TEMP_MEAN_AVG)
df_temperature=inner_join(df_mera_shrp,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_temperature=inner_join(df_temperature,df_mera_temp_month,by="MERRA_ID")
temperature_state_list=sort(unique(df_temperature$STATE_CODE_EXP),decreasing = FALSE)
temperature_year_list=sort(unique(df_temperature$YEAR),decreasing = FALSE)
temperature_month_number_list=sort(unique(df_temperature$MONTH),decreasing = FALSE)
temperature_month_list=c('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')
df_traffic=read.csv("Traffic.csv",stringsAsFactors = FALSE)[,seq(1,6)]
df_traffic=df_traffic %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_traffic=inner_join(df_traffic,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_traffic=df_traffic %>% mutate(LatLong=paste(LATITUDE,LONGITUDE,sep=":"))
colnames(df_traffic)[6]="ESAL"
traffic_state=sort(unique(df_traffic$STATE_CODE_EXP),decreasing = FALSE)
traffic_year=sort(unique(df_traffic$YEAR),decreasing = FALSE)
traffic_SHRP=sort(unique(df_traffic$SHRP_ID))
df_IRI=read.csv("IRI.csv",stringsAsFactors = FALSE)
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US)) %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH,CONSTRUCTION_NO)
df_IRI=df_IRI %>% mutate(IRI_ave=ave(IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH))
df_IRI$VISIT_DATE=as.Date(df_IRI$VISIT_DATE,format ="%m/%d/%Y")
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID) %>% arrange(VISIT_DATE,CONSTRUCTION_NO)
df_IRI=df_IRI %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO,IRI_ave)
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO) %>% summarise(IRI=mean(IRI_ave),Date=min(VISIT_DATE))
df_IRI=df_IRI %>% filter(!is.na(IRI))
IRI_state=sort(unique(df_IRI$STATE_CODE_EXP))
IRI_shrp=unique((df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(SHRP_ID))[,4])
df_cracking=read.csv("AC_Cracking_Crack_Data.csv",stringsAsFactors = FALSE)
df_cracking=df_cracking %>% select(STATE=STATE_CODE_EXP,SHRP=SHRP_ID,Date=SURVEY_DATE,CN=CONSTRUCTION_NO,FL=GATOR_CRACK_A_L,FM=GATOR_CRACK_A_M,FH=GATOR_CRACK_A_H,TNL=TRANS_CRACK_NO_L,TNM=TRANS_CRACK_NO_M,TNH=TRANS_CRACK_NO_H,TLL=TRANS_CRACK_L_L,TLM=TRANS_CRACK_L_M,TLH=TRANS_CRACK_L_H)
df_cracking=df_cracking %>% filter(CN==1)
df_cracking=df_cracking %>% mutate(F=FL+FM+FH,TN=TNL+TNM+TNH,TL=TLL+TLM+TLH)
df_cracking=df_cracking %>% select(STATE,SHRP,Date,F,TN,TL)
df_cracking$Date=as.Date(df_cracking$Date,"%m/%d/%Y")
df_cracking$year=as.integer(format(df_cracking$Date,'%Y'))
df_cracking$F=round(df_cracking$F,2)
crack_state=sort(unique(df_cracking$STATE))
crack_shrp=unique((df_cracking %>% filter(STATE=='Alabama') %>% select(SHRP))[,1])
shiny::runApp()
View(df_pavement_SHRP)
View(df_pavement_info)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Alabama', LAYER_TYPE=='AC')
View(df)
df=df_pavement_info %>% filter(STATE_CODE_EXP==input$state_section_data& LAYER_TYPE==input$layer_type_data&CN==1)
df=df_pavement_info %>% filter(STATE_CODE_EXP=='Alabama', LAYER_TYPE=='AC',CN==1)
data1=quantile(df$REPR_THICKNESS,probs=c(0.25,0.5,0.75))
data1
data1[1]
data2=c(min(df$REPR_THICKNESS),max(df$REPR_THICKNESS))
data2
dff=data.frame('Minimum Thickness'=10)
dff
dff=data.frame('Minimum Thickness'=10)
dim(df)[1]
dff=data.frame(paste('# points for','Alabama',sep=' ')=dim(df)[1],'Minimum thickness'=data2[1],''Maximum thickness'=data2[2],'25%'=data1[1],'50%'=data2[2],'75%'=data2[3])
dff=data.frame('Minimum thickness'=data2[1],''Maximum thickness'=data2[2],'25%'=data1[1],'50%'=data2[2],'75%'=data2[3])
dff=data.frame('Minimum thickness'=data2[1],''Maximum thickness'=data2[2],'25th'=data1[1],'50th'=data2[2],'75th'=data2[3])
dff=data.frame(paste('# points for','Alabama',sep=' ')=dim(df)[1],'Minimum thickness'=data2[1],'Maximum thickness'=data2[2],'25%'=data1[1],'50%'=data2[2],'75%'=data2[3])
dff=data.frame('An'=dim(df)[1],'Minimum thickness'=data2[1],'Maximum thickness'=data2[2],'25%'=data1[1],'50%'=data2[2],'75%'=data2[3])
text=paste('# points for','Alabama',sep=' ')
dff=data.frame(text=dim(df)[1],'Minimum thickness'=data2[1],'Maximum thickness'=data2[2],'25%'=data1[1],'50%'=data2[2],'75%'=data2[3])
View(dff)
text
dff=data.frame(text=dim(df)[1],'Minimum thickness'=data2[1],'Maximum thickness'=data2[2],'25%'=data1[1],'50%'=data2[2],'75%'=data2[3])
dff=data.frame(paste('# points for','Alabama',sep=' ')=dim(df)[1],'Minimum thickness'=data2[1],'Maximum thickness'=data2[2],'25%'=data1[1],'50%'=data2[2],'75%'=data2[3])
dff=data.frame(as.character(paste('# points for','Alabama',sep=' '))=dim(df)[1],'Minimum thickness'=data2[1],'Maximum thickness'=data2[2],'25%'=data1[1],'50%'=data2[2],'75%'=data2[3])
text
dff
colnames(dff)[1]
colnames(dff)[1]=paste('# points for','Alabama',sep=' ')
dff
df_state_duration=df_pavement_SHRP %>% filter(STATE_CODE_EXP=='Alabama')
View(df_state_duration)
df=df_gps %>% filter(STATE_CODE_EXP==input$state_section_data)
df=df_gps %>% filter(STATE_CODE_EXP=='Alabama')
runApp()
dftemp=df_pavement_info %>% filter(STATE_CODE_EXP==input$state_section_data& LAYER_TYPE==input$layer_type_data)
dftemp=df_pavement_info %>% filter(STATE_CODE_EXP=='Alabama'& LAYER_TYPE==input$layer_type_data)
dftemp=df_pavement_info %>% filter(STATE_CODE_EXP=='Alabama'& LAYER_TYPE=='AC')
View(dftemp)
data1=quantile(dftemp$REPR_THICKNESS,probs=c(0.25,0.5,0.75))
round(data1,1)
runApp()
dftemp=df_pavement_info %>% filter(STATE_CODE_EXP=='Alabama'& LAYER_TYPE=='AC')
rownames(dftemp)
runApp()
runApp()
runApp()
dftemp=df_pavement_info %>% filter(STATE_CODE_EXP=='Alabama'& LAYER_TYPE=='AC')
data1=round(quantile(dftemp$REPR_THICKNESS,probs=c(0.25,0.5,0.75)),2)
data1
data2=c(min(dftemp$REPR_THICKNESS),max(dftemp$REPR_THICKNESS))
data2
runApp()
runApp()
runApp()
View(df_temperature)
df=df_temperature %>% filter(STATE_CODE_EXP=='Alabama')
dff=df %>%  group_by(YEAR,MONTH) %>% summarise(min_temp=min(Tave_F),temp_25=quantile(Tave_F,0.25),
temp_50=quantile(Tave_F,0.5),temp_75=quantile(Tave_F,0.75),max_temp=max(Tave_F))
View(dff)
colnames(dff)=c('Year','Month','Min Temp(F)','25th','50th','75th','Maximum Temp (F)')
runApp()
View(df_traffic)
df=df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama') %>% group_by(YEAR) %>% summarise(min_temp=round(min(ESAL),1),temp_25=round(quantile(ESAL,0.25),1),
temp_50=round(quantile(ESAL,0.5),1),temp_75=round(quantile(ESAL,0.75),1),max_temp=round(max(ESAL),1))
View(df)
colnames(df)=c('Year','Min ESAL','25th','50th','75th','Maximum ESAL')
runApp()
View(df_IRI)
View(df_pavement_SHRP)
View(df_pavement_info)
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama')
df2=df_pavement_info %>% filter(STATE_CODE_EXP=='Alabama',LAYER_TYPE=='AC') %>% group_by(SHRP_ID) %>% summarise(ac_th=sum(PEPR_THICKNESS))
colnames(df_pavement_info)
df2=df_pavement_info %>% filter(STATE_CODE_EXP=='Alabama',LAYER_TYPE=='AC') %>% group_by(SHRP_ID) %>% summarise(ac_th=sum(REPR_THICKNESS))
View(df1)
View(df2)
df3=inner_join(df1,df2,by='SHRP_ID')
View(df3)
df3$year=as.integer(format(df3$VISIT_DATE,'%Y'))
format(min(df3 %>% filter(SHRP_ID=='0101') %>% select(VISIT_DATE)),'%Y')
min(df3 %>% filter(SHRP_ID=='0101') %>% select(VISIT_DATE))
x=df3 %>% filter(SHRP_ID=='0101') %>% select(VISIT_DATE)
View(x)
x=df3 %>% filter(SHRP_ID=='0101') %>% select(VISIT_DATE)[,4]
x=df3 %>% filter(SHRP_ID=='0101') %>% select(VISIT_DATE)
x=(df3 %>% filter(SHRP_ID=='0101') %>% select(VISIT_DATE))[,4]
x=min(df3 %>% filter(SHRP_ID=='0101') %>% select(VISIT_DATE))[,4]
x=(df3 %>% filter(SHRP_ID=='0101') %>% select(VISIT_DATE))[,4]
class(x)
x$VISIT_DATE
x=x$VISIT_DATE
runApp()
runApp()
