shiny::runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
library(DT)
DT::dataTableOutput("table")
install.packages('DT')
runApp('RProject/ShinyApp')
round(2.1232329,3)
View(df_pavement_info)
runApp('RProject/ShinyApp')
shiny::runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
shiny::runApp('RProject/ShinyApp')
View(df_traffic)
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
df=df_traffic %>% filter(STATE_CODE_EXP==input$ESAL_state&YEAR==input$ESAL_year) %>% group_by(SHRP_ID) %>% summarise(ave_ESAL=mean(ESAL))
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1995) %>% group_by(SHRP_ID) %>% summarise(ave_ESAL=mean(ESAL))
View(df)
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1995)
df=df_traffic %>% filter(STATE_CODE_EXP==input$ESAL_state&YEAR==input$ESAL_year)
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1995)
ggplot(df)+geom_boxplot(aes(x=YEAR,y=ESAL,group=YEAR))
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama'&YEAR==1950)
df=df_traffic %>% filter(STATE_CODE_EXP=='Alabama')
x=sort(unique(df$YEAR))
length(x)
View(x)
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
rm(list=ls())
shiny::runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
runApp('RProject/ShinyApp')
library(tidyverse)
library(googleVis)
library(DT)
rm(list=ls())
setwd("C:\\Users\\behroozk\\Documents\\RProject\\ShinyApp\\")
rm(list=ls())
df_pavement_SHRP=read.csv("PavementStructure_SHRP_Info.csv",stringsAsFactors = FALSE)
df_pavement_info=read.csv("PavementStructure_Pavement_Info.csv")
Out_of_US=c("Alberta","British Columbia","New Brunswick","Newfoundland","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Manitoba")
df_pavement_info=df_pavement_info %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>%select(STATE_CODE_EXP,SHRP_ID,CONSTRUCTION_NO,LAYER_NO,LAYER_TYPE,LAYER_TYPE_EXP,REPR_THICKNESS)
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(STATE_CODE_EXP %in% Out_of_US))%>% select(STATE_CODE_EXP,STATE_CODE,SHRP_ID,START_DATE,END_DATE)
df_pavement_info$LAYER_TYPE_EXP=str_replace(df_pavement_info$LAYER_TYPE_EXP,"layer","")
df_pavement_info=df_pavement_info %>% filter(!is.na(REPR_THICKNESS))
df_pavement_SHRP$START_DATE=as.Date(df_pavement_SHRP$START_DATE,"%m/%d/%Y")
df_pavement_SHRP$END_DATE=as.Date(df_pavement_SHRP$END_DATE,"%m/%d/%Y")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP$END_DATE=str_replace(df_pavement_SHRP$END_DATE,"2050","2005")
df_pavement_SHRP$duration=as.integer(substr(df_pavement_SHRP$END_DATE,1,4))-as.integer(substr(df_pavement_SHRP$START_DATE,1,4))
df_pavement_SHRP=df_pavement_SHRP %>% filter(!(duration<0))
df_pavement_SHRP=df_pavement_SHRP %>% group_by(STATE_CODE_EXP,STATE_CODE,SHRP_ID) %>% summarise(syear=min(as.integer(substr(START_DATE,1,4))),eyear=max(as.integer(substr(END_DATE,1,4))),duration=sum(duration))
df_pavement_info_AC=df_pavement_info %>% filter(LAYER_TYPE=='AC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
df_pavement_info_PC=df_pavement_info %>% filter(LAYER_TYPE=='PC') %>% group_by(STATE_CODE_EXP,SHRP_ID) %>% summarise(th=sum(REPR_THICKNESS))
pavement_data_AC=inner_join(df_pavement_SHRP,df_pavement_info_AC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
pavement_data_PC=inner_join(df_pavement_SHRP,df_pavement_info_PC,by.x=c('STATE_CODE_EXP','SHRP_ID'),by.y=c('STATE_CODE_EXP','SHRP_ID'))
df_pavement_info$CN=factor(df_pavement_info$CONSTRUCTION_NO)
df_gps=read.csv('GPS.csv',stringsAsFactors = FALSE)[,c(1,2,3,4,5,9)]
df_gps=df_gps %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_gps$ELEVATION=round(df_gps$ELEVATION,digits=2)
state_list=unique(df_pavement_info$STATE_CODE_EXP)
state_list=sort(state_list,decreasing = FALSE)
layer_type_list=sort(unique(df_pavement_info$LAYER_TYPE))
df_mera_shrp=read.csv("MERA_SHRP.csv",stringsAsFactors = FALSE)
df_mera_temp_month=read.csv("MERRA_TEMP_MONTH.csv",stringsAsFactors = FALSE)
df_mera_temp_month=df_mera_temp_month %>% select(!FREEZE_INDEX & !FREEZE_THAW)
df_mera_temp_month=df_mera_temp_month %>% mutate(Tave_F=1.8*TEMP_AVG+32)
df_mera_temp_month=df_mera_temp_month %>% select(!TEMP_AVG & !TEMP_MEAN_AVG)
df_temperature=inner_join(df_mera_shrp,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_temperature=inner_join(df_temperature,df_mera_temp_month,by="MERRA_ID")
temperature_state_list=sort(unique(df_temperature$STATE_CODE_EXP),decreasing = FALSE)
temperature_year_list=sort(unique(df_temperature$YEAR),decreasing = FALSE)
temperature_month_number_list=sort(unique(df_temperature$MONTH),decreasing = FALSE)
temperature_month_list=c('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')
df_traffic=read.csv("Traffic.csv",stringsAsFactors = FALSE)[,seq(1,6)]
df_traffic=df_traffic %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_traffic=inner_join(df_traffic,df_gps,by.x=c("STATE_CODE","SHRP_ID"),by.y=c("STATE_CODE","SHRP_ID"))
df_traffic=df_traffic %>% mutate(LatLong=paste(LATITUDE,LONGITUDE,sep=":"))
colnames(df_traffic)[6]="ESAL"
traffic_state=sort(unique(df_traffic$STATE_CODE_EXP),decreasing = FALSE)
traffic_year=sort(unique(df_traffic$YEAR),decreasing = FALSE)
traffic_SHRP=sort(unique(df_traffic$SHRP_ID))
df_IRI=read.csv("IRI.csv",stringsAsFactors = FALSE)
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US))
df_IRI=df_IRI %>% filter(!(STATE_CODE_EXP %in% Out_of_US)) %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH,CONSTRUCTION_NO)
df_IRI=df_IRI %>% mutate(IRI_ave=ave(IRI_LEFT_WHEEL_PATH,IRI_RIGHT_WHEEL_PATH))
df_IRI$VISIT_DATE=as.Date(df_IRI$VISIT_DATE,format ="%m/%d/%Y")
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID) %>% arrange(VISIT_DATE,CONSTRUCTION_NO)
df_IRI=df_IRI %>% select(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO,IRI_ave)
df_IRI=df_IRI %>% group_by(STATE_CODE,STATE_CODE_EXP,SHRP_ID,VISIT_DATE,CONSTRUCTION_NO) %>% summarise(IRI=mean(IRI_ave),Date=min(VISIT_DATE))
df_IRI=df_IRI %>% filter(!is.na(IRI))
IRI_state=sort(unique(df_IRI$STATE_CODE_EXP))
IRI_shrp=unique((df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(SHRP_ID))[,1])
rm(list=ls())
runApp()
runApp()
runApp()
runApp()
df=df_IRI %>% filter(STATE_CODE_EXP=='Alabama')
x=sort(unique(df$SHRP_ID))
updateSelectizeInput(session ,"IRI_shrp",choices = x,selected = x[1])
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
df=df_IRI %>% filter(STATE_CODE_EXP=='Alabama'&SHRP_ID=='0101') %>% select(Date,CONSTRUCTION_NO,IRI)
View(df)
min_date=min(df$Date)
df$day=as.integer(df$Date-min_date)
ggplot(df)+geom_point(aes(x=day,y=IRI,color=factor(df$CONSTRUCTION_NO),size=5))
ggplot(df)+geom_point(aes(x=day,y=IRI,color=factor(df$CONSTRUCTION_NO)),size=5)
ggplot(df)+geom_point(aes(x=day,y=IRI,color=factor(df$CONSTRUCTION_NO)),size=5)+geom_line(aes(x=day,y=IRI),color='black',linetype='dashed')+
labs(title=paste('IRI Variation for State','rtyrty', 'SHRP id :','0101',sep = ' '),caption=('Data from LTPP'),tag='Figure 1',x='Day after first Construction',y='IRI',color='Construction No')+theme_bw()
labs(title=paste('IRI Variation for State','rtyrty', 'SHRP id :','0101',sep = ' '),caption=('Data from LTPP'),tag='Figure 1',x='Day after first Construction',y='IRI',color='Construction No')+theme_bw()+scale_x_continuous(breaks = seq(0,max(df$day),length.out=10))+theme(axis.text.x = element_text(face="bold", color="#993333",size=12))+theme(axis.text.y = element_text(face="bold", color="#993333",size=12))+theme(axis.title = element_text(size = 14,color='#121111',face='bold'))
runApp()
df=df_IRI %>% filter(STATE_CODE_EXP=='Alabama'&SHRP_ID=='0101') %>% select(Date,CONSTRUCTION_NO,IRI)
IRI_shrp=unique((df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(SHRP_ID))[,1])
View(IRI_shrp)
IRI_shrp=unique(df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(SHRP_ID))
IRI_shrp=unique((df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(SHRP_ID))[,4])
runApp()
runApp()
runApp()
runApp()
runApp()
df1=df_IRI %>% filter(STATE_CODE_EXP=='Alabama') %>% select(Date,CONSTRUCTION_NO,SHRP_ID,IRI) %>% filter(CONSTRUCTION_NO==1)
df1$delta_year=0
df1$delta_IRI=0
for (ishrp in unique(df1$SHRP_ID)) {
min_IRI=min(df1[df1$SHRP_ID==ishrp,'IRI']$IRI)
min_date=as.integer(format(min(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE),'%Y'))
survey_year=as.integer(format(df1[df1$SHRP_ID==ishrp,'VISIT_DATE']$VISIT_DATE,'%Y'))
df1[df1$SHRP_ID==ishrp,'delta_year']$delta_year=as.integer(survey_year-min_date)
df1[df1$SHRP_ID==ishrp,'delta_IRI']$delta_IRI=(df1[df1$SHRP_ID==ishrp,'IRI']$IRI-min_IRI)
}
df1$survey_year=as.integer(format(df1$VISIT_DATE,'%Y'))
df1=df1 %>% group_by(SHRP_ID,survey_year) %>% summarise(dIRI=max(delta_IRI),dyear=min(delta_year))
df2=df_temperature %>% filter(STATE_CODE_EXP=='Alabama') %>% group_by(SHRP_ID,YEAR) %>% summarise(Tave=mean(Tave_F))
df3=df_pavement_info %>% filter(STATE_CODE_EXP=='Alabama'&CONSTRUCTION_NO==1&LAYER_TYPE=='AC') %>%
group_by(SHRP_ID) %>% summarise(ac_th=sum(REPR_THICKNESS))
df4=inner_join(df1,df3,by=c('SHRP_ID'='SHRP_ID','survey_year'='YEAR'))
View(df1)
View(df2)
View(df3)
df4=inner_join(df1,df3,by=c('SHRP_ID'='SHRP_ID'))
View(df4)
df5=inner_join(df4,df2,by=c('SHRP_ID'='SHRP_ID','survey_year'='YEAR'))
View(df5)
df5$dIRI_ac=df5$dIRI/df5$ac_th
runApp()
runApp()
